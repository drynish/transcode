#!/bin/sh
# $1 is first argument from command line (origin file)
# $2 is the second one (transcoded one)

if [ "$#" -ne 2 ]; then
    echo "usage: trancode source destination"
else
	gst-launch-1.0 filesrc location="$1" ! matroskademux name=demux demux. ! \
	queue ! mpegvideoparse ! omxmpeg2videodec ! videocrop bottom=4 top=4 ! videoconvert ! \
	omxh264enc control-rate=variable target-bitrate=3000000 ! \
	"video/x-h264,profile=high" ! h264parse ! \
	progressreport ! \
	mux. demux. ! queue ! ac3parse !\
	avimux name=mux ! filesink location="$2"
fi
